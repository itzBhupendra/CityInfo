using PdfSharp.Pdf;
using PdfSharp.Pdf.IO;

namespace PdfCompressionExample
{
    class Program
    {
        static void Main(string[] args)
        {
            // Load the PDF document
            string inputFilePath = "input.pdf"; // Replace with your input file path
            string outputFilePath = "output.pdf"; // Replace with your output file path

            using (PdfDocument document = PdfReader.Open(inputFilePath, PdfDocumentOpenMode.Modify))
            {
                // Compress images in each page
                foreach (PdfPage page in document.Pages)
                {
                    // Compress images in the current page
                    foreach (var image in page.Elements.OfType<PdfSharp.Pdf.Advanced.PdfImage>())
                    {
                        // You can adjust the quality/compression level here
                        image.TryCompress();
                    }
                }

                // Save the modified document
                document.Save(outputFilePath);
            }
        }
    }
}
