app.Use(async (context, next) =>
{
    var userAgent = context.Request.Headers["User-Agent"].ToString();
    var referer = context.Request.Headers["Referer"].ToString();

    // Check if User-Agent or Referer is missing or doesn't indicate a browser
    if (string.IsNullOrEmpty(userAgent) || !userAgent.Contains("Mozilla") || string.IsNullOrEmpty(referer))
    {
        context.Response.StatusCode = StatusCodes.Status403Forbidden;
        await context.Response.WriteAsync("Forbidden: API calls are only allowed from web browsers.");
        return;
    }

    await next();
});
